# tailwindcss-patch

get tailwindcss context at runtime ! extract all class to json file!

- [tailwindcss-patch](#tailwindcss-patch)
  - [Setup](#setup)
  - [Usage](#usage)
  - [Cli](#cli)
    - [Init Config File](#init-config-file)
    - [Extract all class into a json](#extract-all-class-into-a-json)
    - [Nodejs](#nodejs)
  - [Migration form v1 to v2](#migration-form-v1-to-v2)
    - [2. cli command change](#2-cli-command-change)
    - [1. default remove `*` in json array result](#1-default-remove--in-json-array-result)
  - [Notice](#notice)

> Nodejs version should >= `16.6.0`

## Setup

1. Install package

```sh
<yarn|npm|pnpm> add -D ts-patch
```

2. Patch tailwindcss

```sh
npx tw-patch install
```

3. Add `prepare` script (keeps patch persisted after npm install)

`package.json`

```json
{
  /* ... */
  "scripts": {
    "prepare": "tw-patch install"
  }
}
```

## Usage

## Cli

### Init Config File

```sh
tw-patch init
```

Then there will be a ts file called `tailwindcss-patch.config.ts` exist in your `cwd`.

### Extract all class into a json

```sh
tw-patch extract
```

default there will be a json in `.tw-patch/tw-class-list.json` in your project.

you can custom this behavior by config `tailwindcss-patch.config.ts`

### Nodejs

```js
import { TailwindcssPatcher } from 'tailwindcss-patch'

const twPatcher = new TailwindcssPatcher(/* options */)
// get all contexts at runtime
twPatcher.getContexts()
// get all class generated by tailwindcss utilities
twPatcher.getClassSet()
```

## Migration form v1 to v2

### 2. cli command change

```diff
{
- "tw-patch"
+ "tw-patch install"
}
```

### 1. default remove `*` in json array result

```diff
[
- "*",
  "text-[99px]",
  "text-[100px]"
]
```

## Notice

`getContexts`,`getClassCacheSet` should be invoked after `postcss-loader`'s activation.

which means you may not get tailwindcss contexts at build start time.

you may call them at `generateBundle` lifetime hook in `vite/webpack plugin`.
